table_name: library_usage_patterns
version: "1.0"
record_count: 20000

metadata:
  purpose: "Library resource utilization, checkout patterns, and correlation with academic success"
  updated_at: "2026-01-14"

columns:
  # Student Context (Denormalized)
  - name: student_id
    type: INTEGER
    description: "Unique identifier for each student"
    nullable: false
    statistics:
      min: 1
      max: 10000

  - name: student_first_name
    type: VARCHAR(100)
    description: "Student's first name"
    nullable: false

  - name: student_last_name
    type: VARCHAR(100)
    description: "Student's last name"
    nullable: false

  - name: student_email
    type: VARCHAR(200)
    description: "Student's email address"
    nullable: false

  - name: student_major
    type: VARCHAR(100)
    description: "Student's declared major"
    nullable: false
    value_type: categorical
    possible_values:
      - "Computer Science"
      - "Business"
      - "Engineering"
      - "Biology"
      - "Psychology"
      - "Economics"
      - "Mathematics"
      - "English"
      - "History"
      - "Physics"

  - name: student_gpa
    type: DECIMAL(3,2)
    description: "Student's current GPA"
    nullable: false
    value_type: continuous
    statistics:
      min: 2.00
      max: 4.00

  - name: student_status
    type: VARCHAR(50)
    description: "Current enrollment status"
    nullable: false
    value_type: categorical
    possible_values:
      - "Active"
      - "Graduated"
      - "On Leave"

  - name: student_year
    type: VARCHAR(20)
    description: "Student's academic year level"
    nullable: false
    value_type: categorical
    possible_values:
      - "Freshman"
      - "Sophomore"
      - "Junior"
      - "Senior"

  # Department Context
  - name: department_id
    type: INTEGER
    description: "Department ID associated with student's major"
    nullable: false
    statistics:
      min: 1
      max: 20

  - name: department_name
    type: VARCHAR(100)
    description: "Department name matching student's major"
    nullable: false
    value_type: categorical

  # Resource Details (Denormalized per checkout)
  - name: checkout_id
    type: VARCHAR(50)
    description: "Unique identifier for this checkout transaction"
    nullable: false
    primary_key: true

  - name: book_title
    type: VARCHAR(200)
    description: "Title of the resource checked out"
    nullable: false
    value_type: categorical
    possible_values:
      - "Introduction to Algorithms"
      - "Calculus I"
      - "Modern Physics"
      - "World History"
      - "The Great Gatsby"
      - "Pride and Prejudice"
      - "Chemistry Fundamentals"
      - "Data Structures and Algorithms"
      - "Biology Today"
      - "Economics Principles"
    query_notes: "10 common book titles in dataset"

  - name: author_name
    type: VARCHAR(100)
    description: "Author of the resource"
    nullable: false
    value_type: categorical
    possible_values:
      - "Thomas Cormen"
      - "James Stewart"
      - "Richard Feynman"
      - "Howard Zinn"
      - "F. Scott Fitzgerald"
      - "Jane Austen"
      - "John McMurry"
      - "Robert Sedgewick"
    query_notes: "8 common authors in dataset"

  - name: isbn
    type: VARCHAR(20)
    description: "ISBN-13 number of the resource"
    nullable: false

  - name: resource_category
    type: VARCHAR(50)
    description: "Category of library resource"
    nullable: false
    value_type: categorical
    possible_values:
      - value: "Textbook"
        description: "Course textbooks"
        frequency: 0.20
      - value: "Reference"
        description: "Reference materials"
        frequency: 0.20
      - value: "Fiction"
        description: "Fiction literature"
        frequency: 0.20
      - value: "Research Material"
        description: "Research resources"
        frequency: 0.20
      - value: "Journal"
        description: "Academic journals"
        frequency: 0.20
    query_notes: "Evenly distributed across categories"

  - name: resource_type
    type: VARCHAR(50)
    description: "Type of resource format"
    nullable: false
    value_type: categorical
    possible_values:
      - value: "Book"
        description: "Physical book"
        frequency: 0.20
      - value: "E-Book"
        description: "Electronic book"
        frequency: 0.20
      - value: "Journal"
        description: "Academic journal"
        frequency: 0.20
      - value: "Magazine"
        description: "Magazine"
        frequency: 0.20
      - value: "DVD"
        description: "DVD/multimedia"
        frequency: 0.20
    query_notes: "Evenly distributed across types"

  # Checkout Details
  - name: checkout_date
    type: DATE
    description: "Date when resource was checked out"
    nullable: false
    value_type: continuous
    statistics:
      range: "Last 1 year from data generation date"

  - name: due_date
    type: DATE
    description: "Due date for return"
    nullable: false
    value_type: continuous
    query_notes: "Typically 14-30 days after checkout_date"

  - name: return_date
    type: DATE
    description: "Date when resource was returned"
    nullable: true
    value_type: continuous
    query_notes: "NULL if not yet returned"

  - name: days_checked_out
    type: INTEGER
    description: "Number of days resource has been/was checked out"
    nullable: false
    value_type: continuous
    query_notes: "Calculated as return_date - checkout_date (or current_date if not returned)"

  - name: is_returned
    type: BOOLEAN
    description: "True if resource has been returned"
    nullable: false
    value_type: boolean
    query_notes: "75% of records are returned"

  - name: is_overdue
    type: BOOLEAN
    description: "True if return was/is after due date"
    nullable: false
    value_type: boolean

  - name: overdue_days
    type: INTEGER
    description: "Number of days overdue"
    nullable: false
    value_type: continuous
    statistics:
      min: 0
    query_notes: "0 if not overdue, >0 if overdue"

  - name: overdue_fee
    type: DECIMAL(6,2)
    description: "Fee charged for overdue return"
    nullable: false
    value_type: continuous
    statistics:
      min: 0.00
    query_notes: "Calculated as overdue_days × $0.50"

  # Student Usage Aggregations (Pre-calculated)
  - name: total_checkouts
    type: INTEGER
    description: "Total number of checkouts by this student"
    nullable: false
    value_type: continuous
    statistics:
      min: 5
      max: 50
    query_notes: "Pre-aggregated count per student"

  - name: total_returns
    type: INTEGER
    description: "Total number of items returned"
    nullable: false
    value_type: continuous
    query_notes: "Typically ~85% of total_checkouts"

  - name: total_overdue
    type: INTEGER
    description: "Total number of overdue items"
    nullable: false
    value_type: continuous
    query_notes: "Typically ~15% of total_checkouts"

  - name: current_checkouts
    type: INTEGER
    description: "Number of items currently checked out"
    nullable: false
    value_type: continuous
    query_notes: "Calculated as total_checkouts - total_returns"

  - name: total_overdue_fees
    type: DECIMAL(8,2)
    description: "Total overdue fees accumulated"
    nullable: false
    value_type: continuous
    query_notes: "Sum of all overdue_fee values for student"

  - name: avg_checkout_duration_days
    type: DECIMAL(4,1)
    description: "Average number of days items are checked out"
    nullable: false
    value_type: continuous
    statistics:
      min: 14.0
      max: 25.0

  - name: overdue_rate_pct
    type: DECIMAL(5,2)
    description: "Percentage of checkouts that were overdue"
    nullable: false
    value_type: continuous
    query_notes: "Calculated as (total_overdue / total_checkouts) × 100"

  # Resource Type Breakdown
  - name: textbook_checkouts
    type: INTEGER
    description: "Number of textbook checkouts"
    nullable: false
    value_type: continuous
    query_notes: "Pre-calculated count where resource_category = 'Textbook'"

  - name: reference_checkouts
    type: INTEGER
    description: "Number of reference material checkouts"
    nullable: false
    value_type: continuous
    query_notes: "Pre-calculated count where resource_category = 'Reference'"

  - name: fiction_checkouts
    type: INTEGER
    description: "Number of fiction checkouts"
    nullable: false
    value_type: continuous
    query_notes: "Pre-calculated count where resource_category = 'Fiction'"

  - name: research_material_checkouts
    type: INTEGER
    description: "Number of research material checkouts"
    nullable: false
    value_type: continuous
    query_notes: "Pre-calculated count where resource_category = 'Research Material'"

  # Usage Patterns
  - name: checkouts_this_semester
    type: INTEGER
    description: "Number of checkouts in current semester"
    nullable: false
    value_type: continuous
    statistics:
      min: 3
      max: 15

  - name: checkouts_last_30_days
    type: INTEGER
    description: "Number of checkouts in past 30 days"
    nullable: false
    value_type: continuous
    statistics:
      min: 1
      max: 5

  - name: avg_checkouts_per_month
    type: DECIMAL(4,1)
    description: "Average number of checkouts per month"
    nullable: false
    value_type: continuous
    statistics:
      min: 1.0
      max: 5.0

  - name: usage_frequency
    type: VARCHAR(20)
    description: "Overall library usage frequency classification"
    nullable: false
    value_type: categorical
    possible_values:
      - value: "Heavy"
        description: "Frequent library user"
      - value: "Moderate"
        description: "Regular library user"
      - value: "Light"
        description: "Occasional library user"
      - value: "Rare"
        description: "Infrequent library user"

  # Academic Correlation
  - name: library_usage_gpa_correlation
    type: DECIMAL(4,2)
    description: "Correlation between library usage and GPA"
    nullable: false
    value_type: continuous
    statistics:
      min: 0.20
      max: 0.70
    query_notes: "Positive correlation indicates library usage benefits GPA"

  - name: library_usage_percentile
    type: INTEGER
    description: "Student's library usage percentile"
    nullable: false
    value_type: continuous
    statistics:
      min: 1
      max: 100
    query_notes: "Higher percentile = more library usage"

  # Flags
  - name: is_frequent_user
    type: BOOLEAN
    description: "True if total_checkouts > 20"
    nullable: false
    value_type: boolean
    query_notes: "Identifies students who heavily use library resources"

  - name: has_overdue_items
    type: BOOLEAN
    description: "True if student has unreturned overdue items"
    nullable: false
    value_type: boolean
    query_notes: "Calculated as not is_returned AND is_overdue"

  - name: is_responsible_borrower
    type: BOOLEAN
    description: "True if overdue_rate_pct < 10%"
    nullable: false
    value_type: boolean
    query_notes: "Identifies students with good borrowing behavior"

  - name: has_outstanding_fees
    type: BOOLEAN
    description: "True if overdue_fee > 0"
    nullable: false
    value_type: boolean
    query_notes: "Identifies students with unpaid fees"

# Relationships
relationships:
  - target_table: "student_enrollment_analytics"
    join_keys:
      - student_id
    relationship_type: "many-to-one"
    description: "Multiple checkout records per student"

  - target_table: "student_academic_performance"
    join_keys:
      - student_id
    relationship_type: "many-to-one"
    description: "Can correlate library usage with academic performance"

# Indexes
indexes:
  - columns: [checkout_id]
    type: "primary_key"
  - columns: [student_id]
    type: "index"
    usage: "Frequently used for student-level analysis"
  - columns: [resource_category]
    type: "index"
    usage: "Common filter for resource type analysis"
  - columns: [is_overdue]
    type: "index"
    usage: "Frequently used to identify overdue items"
  - columns: [is_frequent_user]
    type: "index"
    usage: "Common filter for identifying heavy users"
  - columns: [usage_frequency]
    type: "index"
    usage: "Common for usage pattern analysis"
